<!DOCTYPE html>
<html>
<head>
  <title>Python Web App</title>
  <style>
    /* Add your custom styles here */
  </style>
</head>
<body>
  <h1>Python Web App</h1>
  
  <textarea id="codeInput" rows="10" cols="50"></textarea>
  <button id="runButton">Run</button>
  
  <h2>Output:</h2>
  <pre id="outputArea"></pre>
  
  <h2>Errors:</h2>
  <pre id="errorArea"></pre>
  
  <script>
    async function loadPyodide() {
      // Load Pyodide library and initialize it
      const script = document.createElement('script');
      script.src = 'https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js';
      script.async = true;
      document.body.appendChild(script);
      
      // Wait for Pyodide to load
      await new Promise(resolve => {
        script.onload = resolve;
      });
      
      // Initialize Pyodide and return the top-level namespace
      return self.pyodide;
    }
    
    async function runPythonCode() {
      const codeInput = document.getElementById('codeInput');
      const outputArea = document.getElementById('outputArea');
      const errorArea = document.getElementById('errorArea');
      
      // Clear the output and error areas
      outputArea.innerText = '';
      errorArea.innerText = '';
      
      // Retrieve the Python code from the input field
      const pythonCode = codeInput.value;
      
      try {
        // Redirect stdout to capture output
        pyodide.runPython(`
          import io, sys
          sys.stdout = io.StringIO()
        `);
        
        // Execute the Python code
        pyodide.runPython(pythonCode);
        
        // Retrieve the captured output and display it
        const capturedOutput = pyodide.runPython('sys.stdout.getvalue()');
        outputArea.innerText = capturedOutput;
      } catch (error) {
        // Display the error in the dedicated error area
        errorArea.innerText = error.toString();
      }
    }
    
    // Attach the loadPyodide function to the window's onload event
    window.onload = loadPyodide;
    
    // Attach the runPythonCode function to the run button's click event
    const runButton = document.getElementById('runButton');
    runButton.addEventListener('click', runPythonCode);
  </script>
</body>
</html>
